<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Black Hook â€” Viewer</title>
  <style>
    body { margin: 0; background: #000; color: #fff; font-family: sans-serif; overflow: hidden; }
    
    /* The container for the game */
    #game-container {
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    iframe { 
      width: 100%; 
      height: 100%; 
      border: 0; 
      display: block; 
    }
    
    /* Button Styling */
    #fs-btn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 1000;
      padding: 12px 24px;
      background: #dc2626; /* Red color to be visible */
      border: 2px solid #fff;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      border-radius: 6px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.5);
      transition: transform 0.1s;
    }
    #fs-btn:active {
      transform: scale(0.95);
    }
  </style>
</head>
<body>

<div id="game-container"></div>

<button id="fs-btn" onclick="triggerFullscreen()">FULLSCREEN & LOCK</button>

<script>
  // 1. Get the container
  const container = document.getElementById('game-container');

  // 2. Parse the URL to get the game link
  const params = new URLSearchParams(location.search);
  const site = params.get('site');

  if(!site){
    container.innerHTML = '<div style="font-size: 20px;">No game URL provided in ?site= parameter.</div>';
    document.getElementById('fs-btn').style.display = 'none'; // Hide button if no game
  } else {
    // Sanitize URL
    let url = site;
    try { url = decodeURIComponent(site); } catch(e){ url = site; }
    if(!/^[a-zA-Z]+:\/\//.test(url)) url = 'https://' + url;

    // 3. Inject the Iframe
    // Note: We use "allow" for modern browsers and "sandbox" for permissions
    container.innerHTML = `
      <iframe 
        id="game-frame" 
        src="${url}" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; pointer-lock; fullscreen" 
        sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-pointer-lock allow-orientation-lock"
        allowfullscreen="true" 
        webkitallowfullscreen="true" 
        mozallowfullscreen="true">
      </iframe>`;
  }

  // 4. The Magic Function
  function triggerFullscreen() {
    const iframe = document.getElementById('game-frame');
    
    if (!iframe) return;

    // Attempt to fullscreen the IFRAME itself
    if (iframe.requestFullscreen) {
      iframe.requestFullscreen();
    } else if (iframe.webkitRequestFullscreen) { /* Safari */
      iframe.webkitRequestFullscreen();
    } else if (iframe.msRequestFullscreen) { /* IE11 */
      iframe.msRequestFullscreen();
    }

    // CRITICAL: Focus the iframe so it can receive keyboard/mouse input immediately
    iframe.focus();
  }
</script>
</body>
</html>
